Malware = **Mal**icious Soft**ware**
Malware defines a wide wariety of potentially harmfull software.

#### Malware propagation ways

- Free software (crack files, ...)
- File sharing services: during the transfer, the file can be infected (torrent, ...)
- Removable media (firmaware embedded malware, ...)
- Email (attachment, ...)
- Not using firewall or anti-virus

# Trojan

Misleads from its true intention and wait for the best time to attack.
Typically spread by social engineering.

Most common use:

- Create back door
- Gaining unauthorized access
- Steal information
- Infect connected devices
- Ransomware attacks
- Using viction as botnet
- Download other malicious software
- Disable security

### Trojan infection process

- Creating trojan
- Create a dropper
- Create a wrapper
- Propagate the trojan
- Execute dropper

**Trojan Construction Kit**allow attacker to create their own trojan.
Trojans created by using contruction kits can avoid detection from virus and trojan scanning.

Trojan construction kits:

- Dark Horse trojan virus maker
- Senna Spy Generator
- Trojan Horse Construction Kit
- Progenic mail Trojan Construction Kit
- Pandora's Box

### Droppers

Dropper is a program that is designed to deliver a payload on the target machine, install the malware without being detected.

Tools:

- Win32/Rotbrow.A
- Win32/Swisyn
- Win32/Meredrop
- Troj/Destover-C

### Wrappers

Wrapper binds malicious file in order to create and propagate the trojan along with it to avoid detection.
Wrappers often popular executable files, like games, music, etc.

### Crypter

The basic porpuse is to encrypt, obfuscate and manipulate the malware.
By using crypter, it becomes more difficult to detect.
Crypter is used while creating the trojan.

Tools:

- Cryogenic Crypter
- Heaven Crypter
- Swayz Cryptor

### Deployment of trojan

An attacker is upload the trojan on a server, where it can be downloaded immediately when the victiom clikcs on the link

## Types of trojans

#### Command Shell Trojans

- Command Shell Trojans provide a remote control of command shell (i.e. open a port for Netcat)

#### Defacement Trojans

- Defacement Trojans allow attacker to view, edit and extract information, for example User-Styled Custom Application

#### HTTP/HTTPS Trojans

- HTTP/HTTPS Trojans create a http/https tunnel to communicate

#### Botnet trojans

- Botnet is a large scale of compromised system, they spread over the world
- Botnets conrolled by Command and Controll Center
- Used to launch ditributed attacks, like DDoS, spamming

#### Proxy Server Trojans

- Proxy Server Trojans turns the compromised system into a proxy server
- Attacker use this to hide the actual source of the attack

#### Remote Access Trojans (RAT)

- RAT allows the atacker to get remote desktop access to the victim's computer
- RAT includes a back door to maintain the access and control over the victim
- Attacker can monitor user, access information, alter files, etc...

Tools:

- SSH-R.A.T.
- BlackHole RAT
- Pandora RAT

#### Other Types of Trojans

- FTP Trojans
- VNC Trojans
- Mobile Trojans
- ICMP Trojans
- Covert Channel Trojans
- Notification Trojans
- Data Hiding Trojans

#### Trojan Countermeasures

- Avoid to click on suspected email attachments
- Block unused ports
- Monitor network traffic
- Avoid download from untrusted sources
- Install / update security softwares and anti-viruses
- Scan removable media before use
- File integrity
- Enable auditing
- Configure host-based firewall
- Intrusion detection software

#### Detection Techniques for Trojans

- Scanning for suspicious network activities
- Scanning for suspicious ports
- Scanning for suspicious registry entries
- Scanning for suspicious Windows services
- Scanning for suspicious start-up programs
- Scanning for suspicious files and folders
- Scanning for suspicious processes

# Virus and Worms

## Viruses

The virus is a self-replicating program, it is capable of producing multiple copies by attaching with another program.

Characteristics of viruses:

- Infecting other files
- Alteration of data
- Corruption
- Encryption
- Self-replication

### Stages of Virus Life

- Design: develop virus from scratch or using construction kits
- Replication: after the virus is deployed, it will start to spread itself
- Launch: user accidentally launch the infected program
- Detection: the behaviour of a virus is observed, the virus is identified
- Incorporation: developers design a defensive code
- Elimination: update the anti-virus, virus eliminated

### Working of Viruses

#### Infection Phase

During infection phase, virus planted on a target system, replicate itself onto an executable file.
It can be launched when user execute an infected program.
These viruses spread by reproducing and infecting programs, documents or email attachments.
They can enter the operating system through removable drives or any digital media.

#### Attack Phase

File is executed accidentally by user.
Normally, viruses require a triggering action to infect, but they can also have configured to infect upon certain predefined conditions.
